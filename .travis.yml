language: cpp
env:
  - PLUMED_CC=mpicc PLUMED_CXX=mpic++  MAKEDOC=yes
  - PLUMED_CC=clang PLUMED_CXX=clang++ MAKEDOC=no
  - PLUMED_CC=gcc   PLUMED_CXX=g++     MAKEDOC=no
before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -y wget
  - sudo apt-get install -y libopenmpi-dev openmpi-bin
  - sudo apt-get install -y libmatheval-dev
  - ./.travis.sh
install: 
  - touch src/crystallization.on src/manyrestraints.on
# this "which" trick is required since sudo make does not have the path
# to the compiler
  - ./configure CXX=$(which $PLUMED_CXX) CC=$(which $PLUMED_CC) CXXFLAGS="-O3" LDFLAGS="-Wl,-rpath,/usr/lib:/usr/local/lib"
  - make
  - test $MAKEDOC == yes && make doc > makedoc.out || true
  - sudo make install
script:
  - make -C regtest 
